library(simstudy)
library(spAReco)

unemployment = c( -0.03044948, 2.492173, -0.5082721, -0.7401565, 
          0.5668287, 0.63007, -0.002342268, -0.3888164, -0.3185484, -0.1639587, 
          0.63007, -0.9158266, 0.5316947, 0.2857566, 0.3771051, -0.262334, 
          -0.03044948, 0.5738555, -0.2553072, -1.021229, 0.9603297, -0.367736, 
          -1.23906, -0.8947462, 0.06089896, -0.1217979, -0.1780123, -0.6066473, 
          2.302449, 1.536528, 0.6933112, 0.8689813, 3.012156, -0.9439338, 
          0.5598019, -0.7120493, -1.702829, -0.438004, -1.253113, -0.1077443, 
          -1.203926, -1.372569, -0.9579874, 0.5527751, 0.1030598)

employees_with_academic_degree = c( 
  -3.567332, 0.7817374, -1.317813, -0.5251257, 0.03189793, 0.1175939, 
  0.5460736, 0.1175939, -0.7607895, -1.660597, -1.617749, 0.4389537, 
  0.2889858, -0.3965818, 0.5032256, 0.8245854, 0.2032898, 0.2889858, 
  0.6960415, -0.4608537, 0.4818016, -1.167845, -0.11807, 0.6317695, 
  0.7817374, 0.03189793, 0.3961057, 0.01047395, 0.8888574, 0.07474591, 
  -2.389012, -2.217621, 0.3961057, 0.2247138, 0.7603135, 1.060249, 
  0.4818016, 0.4603777, 0.7388895, 0.6960415, 0.2889858, 0.4175297, 
  0.5246496, 0.8674334, 1.145945) 

employment_rate = c( -0.3464448, 0.3778701, 
          -2.002022, -0.8983039, 1.067694, -1.036269, -0.5878832, -0.6223744, 
          -0.03602413, 1.067694, 0.2399054, -1.208725, -0.3119537, 0.2054142, 
          0.5158349, -0.6568656, 0.343379, 0.4468525, 0.2399054, -1.036269, 
          1.654044, 1.067694, -0.7603391, -0.8638127, -0.07051532, -0.7948303, 
          0.5848173, -0.9327951, 1.723027, 1.24015, 1.516079, 0.895238, 
          1.998956, -0.4844096, 0.722782, -0.3464448, -0.03602413, 0.2399054, 
          0.2054142, 1.447097, -1.450163, -1.691601, -2.002022, -0.1739889, 
          0.5503261)

gross_wage_and_salary = c( -1.40453, -2.256426, -4.954538, 0.2122268, 
          0.2359639, 0.3546491, 0.1278284, 0.3124499, 0.3309121, -0.3838369, 
          -1.159247, 0.4997088, -0.3627373, -0.06470544, -0.2229524, 0.2254141, 
          0.3256372, -0.1438289, 0.805653, 0.4100355, 0.7845534, 0.148928, 
          0.7423542, 0.4100355, 0.2280515, -0.06998034, 0.5603702, -0.191303, 
          1.145884, -1.035287, -0.4418608, -0.2493269, -0.2071277, 0.2122268, 
          0.7054299, 0.7792785, 0.1172786, 0.3098125, 0.6869678, 0.9243383, 
          0.700155, 0.383661, 0.1964021, -0.6607691, 0.9322506)

net_household_income = c( 
  -0.4785143, 1.320685, -2.056903, -1.476252, 0.4619762, -1.083699, 
  -0.3803761, -0.02053631, -0.4621579, 0.6010052, 0.1184927, -1.230907, 
  -0.143209, 0.2984126, 0.1593836, 0.2575217, -0.0614272, 0.6010052, 
  -0.2495253, -2.629375, 0.4047289, 0.6010052, -0.740216, -0.650256, 
  0.4374416, -0.8056414, 0.2984126, -1.288154, 1.647812, 1.942226, 
  1.304328, 0.4946889, 2.228463, -0.5439397, 0.6746088, 0.4865107, 
  -0.1759217, 0.5028671, 0.8299942, 1.443358, -1.026452, -0.9773831, 
  -0.9201359, 0.06124546, 0.224809)

school_leavers_without_qualifications = c( 0.1679211, 1.280887, 
          -1.062199, -0.4178502, -0.4764274, 0.5779611, -0.9450445, -1.355084, 
          -0.300696, -1.062199, -0.4178502, -1.120776, -0.5935816, 0.2264983, 
          -0.4764274, -0.007810285, -0.7107359, 0.988001, 0.6951153, -1.296507, 
          1.398041, -0.6521588, -1.413662, -0.2421188, 0.1679211, -0.7107359, 
          -0.06638742, -1.179353, 2.276698, 1.573772, -0.3592731, -0.769313, 
          -1.179353, -0.300696, 1.22231, 0.109344, 0.8708467, 1.925235, 
          -0.06638742, 1.866658, 0.988001, 0.4608068, 1.63235, -1.120776, 
          -0.1249646)
debtor_rate = c( -0.4695535, 1.381241, -1.446362, -0.8808412, 
          1.021364, 0.301611, 0.09596713, -0.1096767, -0.7266083, -0.5209644, 
          0.5072548, -0.5723754, 1.175597, 0.1473781, 0.8671316, 0.1987891, 
          0.6100768, 0.7128987, 0.1473781, -1.34354, 0.6100768, -0.5723754, 
          -1.035074, -0.6237864, 0.1987891, -0.6237864, 0.6614877, -0.8294302, 
          2.460871, 1.689707, -0.006854795, 0.2502, 3.386269, -1.137896, 
          0.09596713, -0.6751973, -0.8808412, -0.2124986, -0.9322521, 
          0.04455617, -1.035074, -1.086485, -1.240718, 0.4044329, -0.006854795) 

tax_revenues = c( -1.684244, 0.3455002, -2.086866, -1.283286, 0.5701031, 
          -0.6128053, 0.3138894, -0.651071, -1.158507, -0.04547515, -1.160171, 
          -0.5412652, -0.09871434, -0.3466093, 0.7547765, 0.5135364, 
          -0.1569447, -0.04713887, 0.03937482, -2.492814, 1.540055, -0.6710357, 
          -1.038719, 0.1125787, 0.4103855, -1.358154, 0.8146706, -0.9688425, 
          0.7930422, 0.8163343, -0.8939748, -0.07708592, 0.691555, 0.2789512, 
          1.332089, 1.791277, 1.030955, 0.3904208, 1.125787, 1.777967, 
          -0.240131, 0.2506679, 0.1874463, 0.1042601, 1.628232)

SMR <- c( 9.273334, 
          6.695489, 14.5262, 14.85044, 15.99267, 9.812473, 10.52268, 13.49649, 4.981858, 10.97441, 13.70725, 12.49931, 9.440578, 10.12146, 4.2168, 8.232485, 
          13.93437, 12.30673, 13.12468, 7.156745, 14.47567, 11.4798, 9.725476, 11.01746, 12.22151, 10.40186, 16.17355, 11.71389, 10.31978, 0, 12.56875, 
          10.34227, 10.48273, 9.726286, 11.0556, 4.168528, 10.81462, 11.16649, 5.888458, 13.02191, 11.54521, 11.79312, 5.69233, 21.34304, 1.762705)

data <- data.frame(unemployment, employees_with_academic_degree, employment_rate, 
                   gross_wage_and_salary, net_household_income,
                   school_leavers_without_qualifications, debtor_rate, tax_revenues,
                   SMR)

stats <- sapply(data, function(x) c(mean = mean(x), var = var(x)))

stats_df <- data.frame(stats)

#simulate every indicator of the deprivation index with the mean and variance 
#of the standardized values
def <- defData(varname = "unemp", dist = "normal", formula = -2.373333e-08, 
               variance = 1)
def <- defData(def, varname = "acad_deg", dist = "normal", formula = -4e-09, 
               variance = 1)
def <- defData(def, varname = "empl", dist = "normal", formula = -2.622222e-08, 
               variance = 1)
def <- defData(def, varname = "salary", dist = "normal", formula = -1.777778e-09, 
               variance = 1)
def <- defData(def, varname = "hh_income", dist = "normal", formula = -5.555556e-09, 
               variance = 1)
def <- defData(def, varname = "no_qual", dist = "normal", formula = -2.777778e-09, 
               variance = 1)
def <- defData(def, varname = "debt", dist = "normal", formula = -3.466667e-08, 
               variance = 1)
def <- defData(def, varname = "tax_rev", dist = "normal", formula = 5.333333e-09, 
               variance = 1)
def <- defData(def, varname = "SMR", dist = "normal", formula = 10.55039, 
               variance = 15.28192)
simulated_data <- genData(45, def)

write.csv(simulated_data, file = "simulated_data.csv")

colnames(simulated_data) <- c("ID", "ZX_1", "ZX_2", "ZX_3", "ZX_4", "ZX_5", "ZX_6",
                  "ZX_7", "ZX_8", "SMR")

#converting the data in WinBUGS format
writeDatafileR(simulated_data, towhere = "simulated_data_final.txt", fill = TRUE)
